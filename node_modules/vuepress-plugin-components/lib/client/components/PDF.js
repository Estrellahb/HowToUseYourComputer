import{isDef as S,isLinkHttp as F,ensureEndingSlash as L,entries as P,useLocaleConfig as y}from"@vuepress/helper/client";import{useScrollLock as D}from"@vueuse/core";import{defineComponent as C,ref as w,onMounted as T,watch as $,onUnmounted as E,h as d}from"vue";import{checkIsiPad as I,checkIsMobile as _,checkIsSafari as R,CancelFullScreenIcon as U,EnterFullScreenIcon as k}from"vuepress-shared/client";import"../styles/pdf.scss";import{withBase as N}from"vuepress/client";import{u as z}from"../useSize-C8GaR9if.js";import{g as H}from"../getLink-DBmDl_2w.js";const p=e=>{console.error(`[PDF]: ${e}`)},M=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},j=e=>e==="string"?document.querySelector(e):e instanceof HTMLElement?e:document.body,B=e=>{let t="";return e&&(t+=P(e).map(([o,r])=>o==="noToolbar"?`toolbar=${r?0:1}`:`${encodeURIComponent(o)}=${encodeURIComponent(r)}`).join("&"),t&&(t=`#${t.slice(0,t.length-1)}`)),t},g=(e,t,o,r,l)=>{M(t);const u=`${e==="pdfjs"?`${L(N(PDFJS_URL))}web/viewer.html?file=${encodeURIComponent(o)}`:o}${B(r)}`,i=e==="pdfjs"||e==="iframe"?"iframe":"embed",n=document.createElement(i);return n.className="pdf-viewer",n.type="application/pdf",n.title=l,n.src=u,n instanceof HTMLIFrameElement&&(n.allow="fullscreen"),t.classList.add("pdf-viewer-container"),t.appendChild(n),t.getElementsByTagName(i)[0]},J=(e,t,{title:o,hint:r,options:l={},force:u})=>{if(typeof window>"u"||!window?.navigator?.userAgent)return null;const{navigator:i}=window,{userAgent:n}=i,c=S(window.Promise),a=I(n)||_(n),h=!a&&R(n),v=!a&&/firefox/iu.test(n)&&n.split("rv:").length>1?parseInt(n.split("rv:")[1].split(".")[0],10)>18:!1,b=!a&&(c||v),f=F(e)?e:__VUEPRESS_DEV__?null:`${window.origin}${e}`;if(!f)return p("PDF link is not accessible."),null;const s=j(t);if(!s)return p("Target element cannot be determined"),null;const m=(o||/\/([^/]+).pdf/.exec(f)?.[1])??"PDF Viewer";return u?PDFJS_URL?g("pdfjs",s,e,l,m):(s.innerHTML=r.replace(/\[url\]/g,f),p("PDFJS URL is not defined"),null):b||!a?g(h?"iframe":"embed",s,e,l,m):PDFJS_URL?g("pdfjs",s,e,l,m):(s.innerHTML=r.replace(/\[url\]/g,e),p("This browser does not support embedded PDFs"),null)};var x=C({name:"PDF",props:{url:{type:String,required:!0},title:{type:String,default:""},width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:void 0},ratio:{type:[String,Number],default:16/9},page:{type:[String,Number],default:1},noToolbar:Boolean,noFullscreen:Boolean,zoom:{type:[String,Number],default:100},viewer:Boolean},setup(e){const{el:t,width:o,height:r,resize:l}=z(e),u=y(PDF_LOCALES),i=w(),n=w(!1);return T(()=>{J(H(e.url),i.value,{title:e.title,hint:u.value.hint,options:{page:e.page,noToolbar:e.noToolbar,...e.zoom.toString()==="100"?{}:{zoom:e.zoom}},force:e.viewer}),l();const c=D(document.body);$(n,a=>{c.value=a}),E(()=>{c.value=!1})}),()=>d("div",{class:["pdf-viewer-wrapper",{fullscreen:n.value}],ref:t,style:n.value?{}:{width:o.value,height:r.value}},[d("div",{ref:i}),e.noFullscreen?null:d("button",{class:"pdf-fullscreen-button",onClick:()=>{n.value=!n.value}},d(n.value?U:k,{class:"pdf-fullscreen-icon"}))])}});export{x as default};
//# sourceMappingURL=PDF.js.map
